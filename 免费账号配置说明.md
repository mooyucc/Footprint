# 免费开发者账号配置说明

## 📋 配置概览

本项目已成功适配**免费 Apple 开发者账号**，可以在没有付费开发者账号的情况下正常运行和测试。

## ✅ 已完成的修改

### 1. 禁用 iCloud 功能
- **文件**: `Footprint.entitlements`
- **修改**: 移除了 iCloud 相关的权限配置
- **影响**: 应用将使用本地存储，数据仅保存在当前设备

### 2. 禁用 Sign in with Apple
- **文件**: `Footprint.entitlements`
- **修改**: 移除了 Apple 登录权限配置
- **影响**: 应用将不需要用户登录

### 3. 修改数据存储方式
- **文件**: `FootprintApp.swift`
- **修改**: 禁用 CloudKit 同步，使用本地 SwiftData 存储
- **影响**: 数据仅保存在本地，不会同步到 iCloud

### 4. 简化用户认证管理
- **文件**: `AppleSignInManager.swift`
- **修改**: 移除 Apple Sign In API 调用
- **影响**: 应用以"本地存储模式"运行

### 5. 更新用户界面
- **文件**: `SettingsView.swift`, `ContentView.swift`
- **修改**: 移除登录按钮，更新说明文字
- **影响**: 用户界面清晰显示当前为本地存储模式

## 🚀 如何使用

### 在 Xcode 中配置

1. **打开项目**
   - 在 Xcode 中打开 `Footprint.xcodeproj`

2. **选择开发团队**
   - 点击项目导航器中的 `Footprint` 项目
   - 选择 `Footprint` target
   - 在 "Signing & Capabilities" 选项卡中
   - 在 "Team" 下拉菜单中选择您的免费账号（显示为 "Personal Team"）

3. **修改 Bundle Identifier（如果需要）**
   - 如果遇到 Bundle Identifier 冲突
   - 将 `Mooyu.Footprint` 改为您的唯一标识符
   - 例如：`com.yourname.Footprint`

4. **运行应用**
   - 连接 iPhone 或使用模拟器
   - 点击运行按钮 ▶️
   - 应用将正常编译和运行

## 📱 功能说明

### ✅ 可用功能
- ✅ 添加/编辑/删除旅行目的地
- ✅ 全球位置搜索（已修复，支持国际地址）
- ✅ 地图显示所有目的地
- ✅ 创建和管理旅程
- ✅ 添加照片和笔记
- ✅ 标记喜爱的目的地
- ✅ 查看旅行统计
- ✅ 本地数据持久化

### ⚠️ 限制功能
- ❌ iCloud 数据同步（数据仅保存在当前设备）
- ❌ 多设备数据共享
- ❌ Sign in with Apple 登录

## 🔄 如何升级到完整功能

如果您需要 iCloud 同步和多设备数据共享功能：

### 1. 注册付费开发者账号
- 访问: https://developer.apple.com/programs/
- 费用: $99/年
- 注册并完成支付

### 2. 在代码中重新启用功能

#### a. 恢复 `Footprint.entitlements`
取消注释以下内容：
```xml
<key>com.apple.developer.icloud-container-identifiers</key>
<array>
    <string>iCloud.$(CFBundleIdentifier)</string>
</array>
<key>com.apple.developer.icloud-services</key>
<array>
    <string>CloudKit</string>
</array>
<key>com.apple.developer.ubiquity-container-identifiers</key>
<array>
    <string>iCloud.$(CFBundleIdentifier)</string>
</array>
<key>com.apple.developer.applesignin</key>
<array>
    <string>Default</string>
</array>
```

#### b. 恢复 `FootprintApp.swift` 中的 CloudKit
取消注释这一行：
```swift
cloudKitDatabase: .automatic
```

#### c. 恢复 `AppleSignInManager.swift`
使用文件末尾注释中的完整代码替换当前的简化版本。

#### d. 恢复视图
根据需要恢复 `SettingsView.swift` 和 `ContentView.swift` 中的登录相关 UI。

### 3. 在 Xcode 中重新配置
- 使用付费账号重新签名
- 在 Xcode 中添加 iCloud 和 Sign in with Apple 能力
- 重新运行应用

## 🐛 故障排除

### 问题: 编译错误 "Cannot create provisioning profile"
**解决方案**: 确保您已按照上述步骤禁用了 iCloud 和 Sign in with Apple 功能

### 问题: 数据丢失
**解决方案**: 
- 本地存储模式下，卸载应用会删除所有数据
- 建议定期备份 iPhone
- 升级到付费账号后可使用 iCloud 自动备份

### 问题: 位置搜索不工作
**解决方案**: 
- 确保设备有网络连接
- 位置搜索需要 Apple Maps 服务
- 现在支持全球地址搜索（包括国外城市）

## 📝 注意事项

1. **数据安全**: 本地存储模式下，数据仅保存在设备上。请定期备份设备。
2. **应用更新**: 更新应用可能导致数据丢失，请在更新前备份。
3. **测试限制**: 免费账号每 7 天需要重新签名应用。
4. **设备限制**: 免费账号最多只能在 3 台设备上测试。

## 🎉 总结

现在您可以：
- ✅ 使用免费开发者账号正常运行应用
- ✅ 测试所有核心功能
- ✅ 在 iPhone 真机上运行
- ✅ 搜索全球任何地点（已修复国际地址搜索）

所有功能都已配置完成，可以立即开始使用！

