# Footprint旅程足迹功能完整说明 🗺️

## 📖 功能概述

旅程功能是 Footprint 的核心功能之一，允许您将多个旅行目的地组织到一个旅程中，并提供丰富的可视化、分享和管理功能。

---

## 🎯 主要功能

### 1. 旅程管理

#### 创建旅程
- 在"旅程"标签页点击右上角的 + 按钮
- 填写旅程信息：
  - **旅程名称**（必填）：如"2025年10月青甘大环线"
  - **描述**（可选）：对这次旅行的简短描述
  - **开始日期和结束日期**
  - **封面图片**（可选）：为旅程添加一张代表性的照片
- 系统会自动计算旅程天数

#### 查看旅程
- 在"旅程"标签页可以看到所有旅程列表
- 每个旅程卡片显示：
  - 旅程名称和描述
  - 封面图片（如果有）
  - 旅程天数
  - 包含的目的地数量

#### 编辑旅程
- 在旅程详情页点击右上角菜单按钮
- 选择"编辑旅程"
- 可以修改旅程的所有信息

#### 删除旅程
- 在旅程详情页点击右上角菜单按钮
- 选择"删除旅程"
- 删除旅程不会删除其中的目的地，只是解除关联

### 2. 目的地关联

#### 方式一：创建新目的地时关联
1. 在"足迹"标签页添加新目的地
2. 在"所属旅程（可选）"部分选择要关联的旅程
3. 保存后，该目的地会自动添加到所选旅程中

#### 方式二：编辑现有目的地时关联
1. 打开目的地详情页
2. 点击右上角的编辑按钮
3. 在"所属旅程（可选）"部分选择或更改旅程
4. 保存即可

#### 方式三：在旅程详情页添加
1. 打开旅程详情页
2. 点击右上角菜单，选择"添加目的地"
3. 可以选择：
   - **创建新目的地**：填写完整的目的地信息
   - **添加现有目的地**：从已有的目的地中选择

### 3. 地图可视化

#### 旅程专属颜色系统
- **统一颜色分配**：所有旅程都使用统一的蓝色标识
- **简化设计**：避免颜色过多造成的视觉混乱
- **智能标记**：属于旅程的所有地点都使用统一的蓝色
- **兼容性**：没有分配到旅程的地点仍然使用原有的国内/国外颜色区分（红/蓝）

#### 旅程路线连接
- **按时间连线**：同一旅程中的地点会按访问日期顺序用线连接
- **视觉效果**：连线颜色根据颜色模式动态调整（深色模式：白色60%透明度，浅色模式：黑色50%透明度），1点线宽
- **一键切换**：地图右上角新增连线切换按钮，可随时开启/关闭连线显示
- **智能显示**：只有包含2个或以上地点的旅程才会显示连线

#### 双层边框标识
- **外圈光环**：属于旅程的地点标记外围会显示一个半透明的彩色圆环
- **视觉层次**：
  - 外圈：蓝紫渐变，80%透明度，3点线宽
  - 主体：标记本身，使用蓝紫渐变填充
  - 内圈：白色边框，2点线宽
- **大小适配**：外圈直径比主标记大8点，确保清晰可见

### 4. 分享功能

#### 图片分享
- 在旅程详情页点击右上角菜单按钮
- 选择"分享旅程"
- 系统会自动生成精美的长图片，完美复现旅程界面
- 图片包含：
  - 旅程标题和描述
  - 时间信息卡片
  - 完整的行程路线
  - 精美的视觉设计
- 支持分享到微信、小红书、微博等平台

#### 分享内容示例
```
📍 2025年10月青甘大环线

穿越青海甘肃的美丽风光

🗓️ 时间：2025年10月1日 - 2025年10月8日
⏱️ 时长：8 天

🌍 行程路线（5个地点）：
1. 西宁 - 中国
2. 青海湖 - 中国
3. 茶卡盐湖 - 中国
4. 敦煌 - 中国
5. 嘉峪关 - 中国

✨ 来自 Footprint 旅程记录
```

---

## 🎨 视觉设计

### 颜色方案

#### 旅程颜色（统一分配）
- **所有旅程**：统一使用蓝色标识
- **简化设计**：避免颜色过多造成的视觉混乱
- **清晰区分**：通过旅程连线和其他视觉元素区分不同旅程

#### 无旅程地点颜色
- 红色：国内地点
- 蓝色：国外地点

### 标记样式

#### 单个地点标记
- **无旅程地点**：⭕ (红色/蓝色)
- **旅程地点**：⊙⭕ (蓝色外圈 + 蓝色标记 + 图标)
- **聚合标记**：⭕5 (包含旅程：蓝紫渐变，普通聚合：颜色填充)
- **旅程连线**：○---○---○ (蓝色虚线连接)

#### 标记尺寸
- **统一尺寸**：所有标记统一使用32点，不根据缩放级别调整
- **简化设计**：保持一致的视觉体验

---

## 📱 使用场景

### 场景 1：青甘大环线
```
旅程：2025年10月青甘大环线
时间：2025年10月1日 - 2025年10月7日
目的地：
  1. 西宁（10月1日）
  2. 青海湖（10月2日）
  3. 茶卡盐湖（10月3日）
  4. 敦煌（10月4日）
  5. 嘉峪关（10月5日）
  6. 张掖（10月6日）
  7. 兰州（10月7日）
```

### 场景 2：欧洲之旅
```
旅程：2024年夏季欧洲之旅
时间：2024年7月10日 - 2024年7月25日
目的地：
  1. 巴黎，法国（7月10-13日）
  2. 阿姆斯特丹，荷兰（7月14-16日）
  3. 柏林，德国（7月17-19日）
  4. 布拉格，捷克（7月20-22日）
  5. 维也纳，奥地利（7月23-25日）
```

---

## 🔧 技术实现

### 数据模型

#### TravelTrip（旅程）
- `id`: 唯一标识符
- `name`: 旅程名称
- `desc`: 旅程描述
- `startDate`: 开始日期
- `endDate`: 结束日期
- `coverPhotoData`: 封面图片数据
- `destinations`: 关联的目的地列表

#### TravelDestination（目的地）
新增字段：
- `trip`: 所属的旅程（可选）

### 技术特点
- 使用 SwiftData 进行数据持久化
- 目的地和旅程之间使用一对多关系
- 支持双向导航（从旅程到目的地，从目的地到旅程）
- 实时更新统计信息（旅程天数、目的地数量等）

---

## 📋 导航结构

应用现在包含 4 个主要标签页：
1. **地图** - 在地图上查看所有目的地
2. **足迹** - 查看所有目的地的列表
3. **旅程** - 查看和管理所有旅程（新增）
4. **我的** - 个人统计和设置

---

## 🎯 最佳实践

### 1. 创建旅程时
- 为旅程起一个简短且有意义的名称
- 设置准确的开始和结束日期
- 添加地点时确保访问日期正确，这样连线顺序才正确

### 2. 查看地图时
- 放大到适当级别以避免过多聚合
- 使用连线功能查看旅程路线
- 点击地点查看详细信息和所属旅程

### 3. 规划新旅程
- 先创建旅程，再添加地点
- 利用不同颜色快速识别不同旅程
- 通过连线检查旅程路线是否合理

### 4. 分享旅程
- 为旅程设置精美的封面图片
- 完善描述信息，添加有意义的旅程描述
- 合理安排行程，按时间顺序排列目的地
- 选择合适的分享时机：旅行前分享规划，旅行后分享回忆

---

## ⚠️ 注意事项

1. **一个目的地只能属于一个旅程**
2. **删除旅程不会删除其中的目的地**
3. **旅程中的目的地按访问日期排序**
4. **可以随时修改目的地所属的旅程**
5. **旅程的封面图片是可选的**
6. **统一颜色**：所有旅程都使用统一的蓝色标识
7. **聚合显示**：在较小缩放级别时，多个地点会聚合成一个标记
8. **性能优化**：连线只在需要时绘制，不影响地图性能
9. **兼容性**：新功能完全兼容现有的国内/国外分类系统

---

## 🚀 未来计划

### 功能增强
- [ ] 导出旅程为 PDF 或图片
- [ ] 旅程模板
- [ ] 预算管理
- [ ] 旅程时间线视图
- [ ] 按旅程生成旅行报告

### 分享功能
- [ ] 支持多种图片模板选择
- [ ] 添加水印和个性化元素
- [ ] 支持批量生成多个旅程图片
- [ ] 添加图片编辑功能（滤镜、文字等）
- [ ] 支持视频分享功能

---

## 📞 使用帮助

### 常见问题

#### Q: 如何在地图上区分不同旅程？
A: 所有旅程都使用统一的蓝色标识，通过旅程连线和其他视觉元素来区分不同旅程。

#### Q: 可以修改旅程的颜色吗？
A: 目前所有旅程都使用统一的蓝色标识，未来版本会考虑添加自定义颜色功能。

#### Q: 旅程分享支持哪些平台？
A: 支持所有 iOS 原生分享功能，包括微信、小红书、微博、短信、邮件等。

#### Q: 删除旅程会影响目的地吗？
A: 不会，删除旅程只是解除关联，目的地本身不会被删除。

---

**现在就开始创建你的第一个旅程吧！** 🎉

通过旅程功能，你可以更好地组织和分享你的旅行经历，让每一次旅行都成为珍贵的回忆。
