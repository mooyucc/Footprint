# 城市数据管理器使用说明（多语言版）

## 概述

`CityDataManager` 是一个集中管理预设城市数据的单例类，支持多语言显示。根据用户的语言环境自动返回对应的城市和国家名称，提供本地化的搜索体验。

## 🌍 多语言特性

### 自动语言检测
- 根据设备的语言设置自动选择显示语言
- 中文环境显示中文名称，英文环境显示英文名称
- 支持中英文搜索，但返回结果会根据当前语言环境显示

### 本地化显示
```swift
// 中文环境下的搜索结果
let cityInfo = CityDataManager.shared.findCity(by: "london")
print(cityInfo.localizedName)    // 输出: "伦敦"
print(cityInfo.localizedCountry) // 输出: "英国"

// 英文环境下的搜索结果
let cityInfo = CityDataManager.shared.findCity(by: "伦敦")
print(cityInfo.localizedName)    // 输出: "London"
print(cityInfo.localizedCountry) // 输出: "United Kingdom"
```

## 主要功能

### 1. 城市搜索（多语言）
```swift
// 查找城市 - 自动返回本地化名称
if let cityInfo = CityDataManager.shared.findCity(by: "巴黎") {
    print("找到城市: \(cityInfo.localizedName)")      // 中文环境: "巴黎", 英文环境: "Paris"
    print("国家: \(cityInfo.localizedCountry)")        // 中文环境: "法国", 英文环境: "France"
    print("坐标: (\(cityInfo.latitude), \(cityInfo.longitude))")
}

### 2. 获取所有城市
```swift
let allCities = CityDataManager.shared.getAllCities()
print("共有 \(allCities.count) 个预设城市")
```

### 3. 按国家查找城市（多语言）
```swift
let usCities = CityDataManager.shared.getCities(by: "United States")
print("美国城市: \(usCities.map { $0.localizedName })")  // 根据语言环境显示对应名称
```

### 4. 按地区分组（多语言）
```swift
let citiesByRegion = CityDataManager.shared.getCitiesByRegion()
for (region, cities) in citiesByRegion {
    print("\(region): \(cities.map { $0.localizedName })")  // 本地化城市名称
}
```

## 预设城市列表（已扩展）

### 欧洲城市（25个）
- **英国**：伦敦、爱丁堡、曼彻斯特、利物浦
- **法国**：巴黎
- **意大利**：罗马、佛罗伦萨、威尼斯、米兰
- **西班牙**：巴塞罗那、马德里、塞维利亚、瓦伦西亚
- **荷兰**：阿姆斯特丹、鹿特丹、乌得勒支、海牙
- **俄罗斯**：莫斯科
- **德国**：柏林、慕尼黑、汉堡、科隆
- **希腊**：雅典、圣托里尼、塞萨洛尼基、罗德岛
- **奥地利**：维也纳、萨尔茨堡、因斯布鲁克、格拉茨
- **冰岛**：雷克雅未克、维克、阿克雷里、赫本
- **爱尔兰**：都柏林、戈尔韦、科克、基拉尼
- **土耳其**：伊斯坦布尔、安卡拉、安塔利亚、伊兹密尔

### 亚洲城市（18个）
- **日本**：东京、京都、大阪、札幌
- **韩国**：首尔、釜山、济州岛、仁川
- **新加坡**：新加坡
- **泰国**：曼谷、清迈、普吉岛、芭堤雅
- **印度**：新德里、孟买、斋浦尔、果阿
- **越南**：河内、胡志明市、岘港、下龙市

### 美洲城市（12个）
- **美国**：纽约、洛杉矶、华盛顿哥伦比亚特区、拉斯维加斯
- **墨西哥**：墨西哥城、坎昆、瓜达拉哈拉、蒙特雷
- **加拿大**：多伦多、温哥华、蒙特利尔、渥太华
- **巴西**：巴西利亚、里约热内卢、圣保罗、萨尔瓦多

### 大洋洲城市（8个）
- **澳大利亚**：悉尼、堪培拉、墨尔本、布里斯班
- **新西兰**：惠灵顿、奥克兰、皇后镇、基督城

### 中东城市（7个）
- **阿联酋**：迪拜、阿布扎比、沙迦、艾因
- **埃及**：开罗、卢克索、亚历山大、沙姆沙伊赫

### 其他地区（4个）
- **葡萄牙**：里斯本、波尔图、法鲁、辛特拉

**总计：74个城市**（支持中英文搜索）

## 如何添加新城市

### 方法1：直接修改 CityDataManager.swift

在 `internationalCities` 字典中添加新条目：

```swift
private let internationalCities: [String: CityInfo] = [
    // 现有城市...
    
    // 新添加的城市（多语言支持）
    "berlin": CityInfo(englishName: "Berlin", chineseName: "柏林", country: "Germany", latitude: 52.5200, longitude: 13.4050),
    "柏林": CityInfo(englishName: "Berlin", chineseName: "柏林", country: "Germany", latitude: 52.5200, longitude: 13.4050),
    
    "vienna": CityInfo(englishName: "Vienna", chineseName: "维也纳", country: "Austria", latitude: 48.2082, longitude: 16.3738),
    "维也纳": CityInfo(englishName: "Vienna", chineseName: "维也纳", country: "Austria", latitude: 48.2082, longitude: 16.3738),
]
```

### 方法2：使用扩展文件

参考 `CityDataManager+Extensions.swift` 中的示例，了解如何添加更多城市。

## 搜索特性

### 支持中英文搜索
- 输入 "london" 或 "伦敦" 都能找到伦敦
- 输入 "paris" 或 "巴黎" 都能找到巴黎

### 模糊搜索
- 支持部分匹配
- 自动处理大小写和空格

### 快速响应
- 无需网络请求
- 立即返回结果
- 绕过 Apple Maps API 限制

## 技术实现

### 数据结构（多语言版）
```swift
struct CityInfo {
    let englishName: String      // 英文名称
    let chineseName: String      // 中文名称
    let country: String          // 国家名称
    let latitude: Double         // 纬度
    let longitude: Double        // 经度
    
    // 自动本地化属性
    var localizedName: String    // 根据语言环境返回对应名称
    var localizedCountry: String // 根据语言环境返回对应国家名称
}
```

### 单例模式
```swift
class CityDataManager {
    static let shared = CityDataManager()
    private init() {}
}
```

## 使用场景

1. **添加目的地时**：在 `AddDestinationView` 中搜索国外城市
2. **编辑目的地时**：在 `EditDestinationView` 中修改城市信息
3. **地图搜索**：快速定位到预设城市
4. **数据验证**：验证城市名称和坐标的准确性

## 优势

- ✅ **绕过限制**：解决中国地区无法搜索国外地点的问题
- ✅ **快速响应**：无需网络请求，立即返回结果
- ✅ **准确数据**：使用官方准确坐标
- ✅ **易于维护**：集中管理，方便添加新城市
- ✅ **多语言支持**：自动根据语言环境显示对应名称
- ✅ **智能本地化**：城市和国家名称自动本地化
- ✅ **可扩展性**：可以轻松添加更多城市和语言

## 注意事项

1. **坐标数据准确性**：坐标数据来源于官方地图服务，确保准确性
2. **多语言完整性**：添加新城市时，必须同时添加中英文名称
3. **语言环境检测**：系统会自动检测用户的语言环境并显示对应名称
4. **数据一致性**：确保中英文名称对应同一个城市
5. **定期更新**：定期更新城市数据，保持信息的时效性
6. **用户需求优先**：考虑用户需求，优先添加热门旅游城市
