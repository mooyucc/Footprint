# Sign in with Apple çœŸæœºæµ‹è¯•æ•…éšœæ’é™¤æŒ‡å—

## ğŸ”´ é—®é¢˜ï¼šç‚¹å‡» "Sign in with Apple" æŒ‰é’®æ²¡æœ‰ååº”

è¿™æ˜¯**æ­£å¸¸ç°è±¡**ï¼Œå› ä¸ºè¿˜éœ€è¦åœ¨ Xcode ä¸­å®Œæˆå¿…è¦çš„é…ç½®ã€‚

---

## âœ… è§£å†³æ–¹æ¡ˆï¼ˆæŒ‰é¡ºåºæ‰§è¡Œï¼‰

### æ­¥éª¤ 1: æ£€æŸ¥ Xcode é¡¹ç›®é…ç½®

#### 1.1 æ‰“å¼€é¡¹ç›®å¹¶é€‰æ‹©æ­£ç¡®çš„ Target
1. åœ¨ Xcode ä¸­æ‰“å¼€ `Footprint.xcodeproj`
2. åœ¨å·¦ä¾§é¡¹ç›®å¯¼èˆªå™¨ä¸­ï¼Œç‚¹å‡»æœ€é¡¶éƒ¨çš„è“è‰²é¡¹ç›®å›¾æ ‡ `Footprint`
3. åœ¨ä¸­é—´æ  `TARGETS` åˆ—è¡¨ä¸­ï¼Œé€‰æ‹© `Footprint`ï¼ˆä¸æ˜¯ PROJECTï¼‰

#### 1.2 è¿›å…¥ Signing & Capabilities æ ‡ç­¾
1. ç‚¹å‡»é¡¶éƒ¨çš„ `Signing & Capabilities` æ ‡ç­¾
2. ç¡®ä¿é€‰æ‹©äº† `Debug` æˆ– `All` é…ç½®

---

### æ­¥éª¤ 2: é…ç½® Team å’Œ Signing

#### 2.1 è®¾ç½® Teamï¼ˆé‡è¦ï¼ï¼‰
```
âœ… å‹¾é€‰ "Automatically manage signing"
âœ… Team: é€‰æ‹©ä½ çš„ Apple IDï¼ˆä¸ªäººå›¢é˜Ÿï¼‰
âœ… Bundle Identifier: ä¼šè‡ªåŠ¨ç”Ÿæˆï¼Œä¾‹å¦‚ "com.yourname.Footprint"
```

**ğŸ“ æ³¨æ„äº‹é¡¹ï¼š**
- å¦‚æœæ²¡æœ‰ Team é€‰é¡¹ï¼Œéœ€è¦å…ˆåœ¨ Xcode ä¸­ç™»å½• Apple IDï¼š
  - Xcode > Settings (æˆ– Preferences) > Accounts
  - ç‚¹å‡» "+" æ·»åŠ  Apple ID
  - ç™»å½•åå°±å¯ä»¥åœ¨ Team ä¸­é€‰æ‹©ä½ çš„ä¸ªäººå›¢é˜Ÿ

#### 2.2 æ£€æŸ¥ Signing çŠ¶æ€
ç¡®ä¿çœ‹åˆ°ç»¿è‰²çš„ âœ… å’Œ "Signing Certificate: Apple Development"

---

### æ­¥éª¤ 3: æ·»åŠ  Capabilitiesï¼ˆæœ€å…³é”®ï¼ï¼‰

#### 3.1 æ·»åŠ  "Sign in with Apple" Capability

1. **åœ¨ `Signing & Capabilities` æ ‡ç­¾é¡µä¸­**
2. **ç‚¹å‡»å·¦ä¸Šè§’çš„ `+ Capability` æŒ‰é’®**
3. **åœ¨æœç´¢æ¡†ä¸­è¾“å…¥ "Sign in with Apple"**
4. **åŒå‡» "Sign in with Apple" æ·»åŠ **

æ·»åŠ æˆåŠŸåï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ªæ–°çš„å¡ç‰‡ï¼š
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  Sign in with Apple              â•‘
â•‘  âœ… Enabled                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

#### 3.2 æ·»åŠ  "iCloud" Capabilityï¼ˆç”¨äºæ•°æ®åŒæ­¥ï¼‰

1. **å†æ¬¡ç‚¹å‡» `+ Capability` æŒ‰é’®**
2. **æœç´¢å¹¶æ·»åŠ  "iCloud"**
3. **åœ¨ iCloud å¡ç‰‡ä¸­ï¼Œå‹¾é€‰ âœ… CloudKit**
4. **åœ¨ Containers ä¸­ï¼Œç¡®ä¿æœ‰ä¸€ä¸ªé»˜è®¤å®¹å™¨**

åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¿™æ ·ï¼š
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  iCloud                          â•‘
â•‘  Services:                       â•‘
â•‘    âœ… CloudKit                   â•‘
â•‘  Containers:                     â•‘
â•‘    â˜‘ï¸ iCloud.com.xxx.Footprint   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

### æ­¥éª¤ 4: æ£€æŸ¥ Entitlements æ–‡ä»¶

#### 4.1 ç¡®è®¤æ–‡ä»¶å­˜åœ¨
åœ¨é¡¹ç›®å¯¼èˆªå™¨ä¸­ï¼Œåº”è¯¥èƒ½çœ‹åˆ° `Footprint.entitlements` æ–‡ä»¶

#### 4.2 æ£€æŸ¥æ–‡ä»¶å†…å®¹
ç‚¹å‡» `Footprint.entitlements`ï¼Œç¡®è®¤åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>com.apple.developer.applesignin</key>
	<array>
		<string>Default</string>
	</array>
	<key>com.apple.developer.icloud-container-identifiers</key>
	<array>
		<string>iCloud.$(CFBundleIdentifier)</string>
	</array>
	<key>com.apple.developer.icloud-services</key>
	<array>
		<string>CloudKit</string>
	</array>
</dict>
</plist>
```

---

### æ­¥éª¤ 5: æ£€æŸ¥è®¾å¤‡è®¾ç½®

#### 5.1 ç¡®è®¤ iPhone å·²ç™»å½• Apple ID
1. æ‰“å¼€ iPhone çš„ **è®¾ç½®** åº”ç”¨
2. é¡¶éƒ¨åº”è¯¥æ˜¾ç¤ºä½ çš„ Apple ID åç§°å’Œå¤´åƒ
3. å¦‚æœæ²¡æœ‰ï¼Œç‚¹å‡» "ç™»å½• iPhone" å¹¶ä½¿ç”¨ä½ çš„ Apple ID ç™»å½•

#### 5.2 æ£€æŸ¥ç½‘ç»œè¿æ¥
- ç¡®ä¿ iPhone è¿æ¥åˆ° Wi-Fi æˆ–èœ‚çªç½‘ç»œ
- Sign in with Apple éœ€è¦ç½‘ç»œè¿æ¥éªŒè¯

---

### æ­¥éª¤ 6: é‡æ–°æ„å»ºå’Œè¿è¡Œ

#### 6.1 æ¸…ç†æ„å»º
1. åœ¨ Xcode ä¸­ï¼Œç‚¹å‡»èœå•æ  `Product` > `Clean Build Folder`
2. æˆ–æŒ‰å¿«æ·é”®ï¼š`Shift + Command + K`

#### 6.2 é‡æ–°è¿è¡Œ
1. ç¡®ä¿é€‰æ‹©äº†ä½ çš„ iPhone 16 ä½œä¸ºè¿è¡Œè®¾å¤‡
2. ç‚¹å‡» â–¶ï¸ è¿è¡ŒæŒ‰é’®ï¼ˆæˆ– `Command + R`ï¼‰
3. åº”ç”¨ä¼šé‡æ–°å®‰è£…åˆ°æ‰‹æœºä¸Š

#### 6.3 æµ‹è¯•ç™»å½•
1. æ‰“å¼€åº”ç”¨
2. è¿›å…¥ "æˆ‘çš„" æ ‡ç­¾é¡µ
3. ç‚¹å‡» "ç™»å½• Apple ID" æˆ–è®¾ç½®æŒ‰é’®
4. ç‚¹å‡» "Sign in with Apple" æŒ‰é’®
5. **åº”è¯¥ä¼šå¼¹å‡º Apple ç™»å½•ç•Œé¢ï¼**

---

## ğŸ¯ é¢„æœŸçš„ç™»å½•æµç¨‹

### æ­£ç¡®é…ç½®åï¼Œç‚¹å‡»æŒ‰é’®åº”è¯¥å‡ºç°ï¼š

1. **å¼¹å‡º Apple ç™»å½•ç•Œé¢**
   - æ˜¾ç¤º "ä½¿ç”¨ Apple ç™»å½•"
   - æ˜¾ç¤ºä½ çš„ Apple ID
   - è¦æ±‚ Face ID / Touch ID éªŒè¯

2. **æˆæƒé€‰é¡¹**
   - é€‰æ‹©æ˜¯å¦å…±äº«é‚®ç®±
   - é€‰æ‹©æ˜¯å¦å…±äº«çœŸå®å§“å

3. **éªŒè¯èº«ä»½**
   - ä½¿ç”¨ Face ID æˆ– Touch ID ç¡®è®¤

4. **ç™»å½•æˆåŠŸ**
   - ç•Œé¢è¿”å›åº”ç”¨
   - æ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯
   - æ˜¾ç¤º "iCloud å·²åŒæ­¥" çŠ¶æ€

---

## ğŸ› å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ³•

### é—®é¢˜ 1: æ²¡æœ‰ Team å¯ä»¥é€‰æ‹©
**åŸå› ï¼š** æ²¡æœ‰åœ¨ Xcode ä¸­ç™»å½• Apple ID

**è§£å†³æ–¹æ³•ï¼š**
1. Xcode > Settings > Accounts
2. ç‚¹å‡» "+" æ·»åŠ  Apple ID
3. è¾“å…¥ä½ çš„ Apple ID å’Œå¯†ç 
4. è¿”å› Signing & Capabilitiesï¼Œåº”è¯¥å¯ä»¥çœ‹åˆ° Team äº†

---

### é—®é¢˜ 2: æ·»åŠ  Capability åå‡ºç°çº¢è‰²é”™è¯¯
**å¯èƒ½åŸå› ï¼š**
- Bundle ID å·²è¢«å…¶ä»–åº”ç”¨ä½¿ç”¨
- Team æ²¡æœ‰æ­£ç¡®è®¾ç½®

**è§£å†³æ–¹æ³•ï¼š**
1. ä¿®æ”¹ Bundle Identifierï¼ˆåœ¨ General æ ‡ç­¾é¡µï¼‰
   - ä¾‹å¦‚ä» `com.example.Footprint` æ”¹ä¸º `com.yourname.Footprint`
2. é‡æ–°é€‰æ‹© Team
3. ç­‰å¾… Xcode è‡ªåŠ¨ä¿®å¤ï¼ˆå¯èƒ½éœ€è¦å‡ ç§’é’Ÿï¼‰

---

### é—®é¢˜ 3: ç‚¹å‡»æŒ‰é’®åé—ªé€€æˆ–å¡æ­»
**åŸå› ï¼š** Capabilities é…ç½®ä¸å®Œæ•´

**è§£å†³æ–¹æ³•ï¼š**
1. ç¡®è®¤ "Sign in with Apple" capability å·²æ·»åŠ 
2. ç¡®è®¤ Entitlements æ–‡ä»¶å­˜åœ¨ä¸”å†…å®¹æ­£ç¡®
3. æ¸…ç†æ„å»ºå¹¶é‡æ–°è¿è¡Œ

---

### é—®é¢˜ 4: æç¤º "This app is not available in your country or region"
**åŸå› ï¼š** å¼€å‘ç¯å¢ƒæ­£å¸¸ï¼Œè¿™ä¸åº”è¯¥å‡ºç°

**è§£å†³æ–¹æ³•ï¼š**
- æ£€æŸ¥ Apple ID çš„å›½å®¶/åœ°åŒºè®¾ç½®
- ä½¿ç”¨ç¾å›½æˆ–ä¸­å›½åŒºçš„ Apple ID

---

### é—®é¢˜ 5: å¼€å‘é˜¶æ®µèƒ½å¦ä½¿ç”¨ Sign in with Appleï¼Ÿ
**ç­”æ¡ˆï¼šèƒ½ï¼âœ…**

- âœ… **å…è´¹ Apple Developer Account** å¯ä»¥åœ¨å¼€å‘é˜¶æ®µä½¿ç”¨
- âœ… å¯ä»¥åœ¨çœŸæœºä¸Šæµ‹è¯•ï¼ˆä¸éœ€è¦ä»˜è´¹è´¦æˆ·ï¼‰
- âœ… å¯ä»¥ä½¿ç”¨æ‰€æœ‰ Sign in with Apple åŠŸèƒ½
- âš ï¸ **ä½†æ˜¯ï¼š** è¦å‘å¸ƒåˆ° App Store éœ€è¦ä»˜è´¹çš„å¼€å‘è€…è´¦æˆ·ï¼ˆ$99/å¹´ï¼‰

---

## ğŸ“‹ é…ç½®æ£€æŸ¥æ¸…å•

åœ¨å°è¯•ç™»å½•å‰ï¼Œè¯·ç¡®è®¤ä»¥ä¸‹æ‰€æœ‰é¡¹ç›®ï¼š

### Xcode é…ç½®
- [ ] å·²æ·»åŠ  "Sign in with Apple" capability
- [ ] å·²æ·»åŠ  "iCloud" capability
- [ ] å·²å‹¾é€‰ "CloudKit"
- [ ] å·²é€‰æ‹© Team
- [ ] å·²å‹¾é€‰ "Automatically manage signing"
- [ ] Signing çŠ¶æ€æ˜¾ç¤ºç»¿è‰² âœ…
- [ ] Entitlements æ–‡ä»¶å­˜åœ¨å¹¶åŒ…å«æ­£ç¡®å†…å®¹

### è®¾å¤‡é…ç½®
- [ ] iPhone å·²ç™»å½• Apple ID
- [ ] ç½‘ç»œè¿æ¥æ­£å¸¸
- [ ] åº”ç”¨å·²æˆåŠŸå®‰è£…åˆ°è®¾å¤‡

### ä»£ç é…ç½®
- [ ] `AppleSignInManager.swift` å·²å¯¼å…¥ Combine
- [ ] `FootprintApp.swift` å·²æ·»åŠ  @StateObject
- [ ] `SettingsView.swift` å­˜åœ¨ä¸”æ­£ç¡®

---

## ğŸ¬ å®Œæ•´é…ç½®è§†é¢‘æ­¥éª¤

### æ­¥éª¤æ€»ç»“ï¼š
1. âœ… Xcode > é€‰æ‹©é¡¹ç›® Footprint
2. âœ… é€‰æ‹© Target "Footprint"
3. âœ… Signing & Capabilities æ ‡ç­¾
4. âœ… é€‰æ‹© Team
5. âœ… æ·»åŠ  "Sign in with Apple" capability
6. âœ… æ·»åŠ  "iCloud" capabilityï¼ˆå‹¾é€‰ CloudKitï¼‰
7. âœ… Clean Build Folder
8. âœ… é‡æ–°è¿è¡Œåˆ° iPhone 16
9. âœ… æµ‹è¯•ç™»å½•ï¼

---

## ğŸ’¡ å¿«é€ŸéªŒè¯æ–¹æ³•

### å¦‚ä½•çŸ¥é“é…ç½®æ˜¯å¦æˆåŠŸï¼Ÿ

1. **åœ¨ Xcode ä¸­æ£€æŸ¥ï¼š**
   - Signing & Capabilities æ ‡ç­¾ä¸­èƒ½çœ‹åˆ°ä¸¤ä¸ª capability å¡ç‰‡
   - Signing çŠ¶æ€æ˜¯ç»¿è‰² âœ…
   - æ²¡æœ‰çº¢è‰²æˆ–é»„è‰²è­¦å‘Š

2. **åœ¨åº”ç”¨ä¸­æ£€æŸ¥ï¼š**
   - ç‚¹å‡» "Sign in with Apple" æŒ‰é’®
   - **å¦‚æœå¼¹å‡º Apple ç™»å½•ç•Œé¢ = æˆåŠŸï¼** âœ…
   - **å¦‚æœæ²¡æœ‰ååº” = è¿˜éœ€è¦æ£€æŸ¥é…ç½®** âš ï¸

---

## ğŸ”§ ç»ˆæè§£å†³æ–¹æ¡ˆ

å¦‚æœä»¥ä¸Šæ‰€æœ‰æ–¹æ³•éƒ½å°è¯•è¿‡äº†è¿˜æ˜¯ä¸è¡Œï¼š

### æ–¹æ³• 1: é‡æ–°åˆ›å»ºé¡¹ç›®é…ç½®
1. åˆ é™¤ `DerivedData` æ–‡ä»¶å¤¹ï¼š
   ```bash
   rm -rf ~/Library/Developer/Xcode/DerivedData
   ```
2. é‡å¯ Xcode
3. é‡æ–°æ‰“å¼€é¡¹ç›®
4. é‡æ–°æ·»åŠ  Capabilities

### æ–¹æ³• 2: æ£€æŸ¥æ§åˆ¶å°æ—¥å¿—
1. åœ¨ Xcode ä¸­è¿è¡Œåº”ç”¨
2. ç‚¹å‡»ç™»å½•æŒ‰é’®
3. æŸ¥çœ‹æ§åˆ¶å°ï¼ˆåº•éƒ¨é¢æ¿ï¼‰æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯
4. å°†é”™è¯¯ä¿¡æ¯å¤åˆ¶ä¸‹æ¥ï¼Œæ–¹ä¾¿è¯Šæ–­

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœä»ç„¶æ— æ³•è§£å†³ï¼Œè¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š

1. **Xcode ç‰ˆæœ¬ï¼š** ï¼ˆå¸®åŠ© > å…³äº Xcodeï¼‰
2. **iOS ç‰ˆæœ¬ï¼š** iPhone 16 çš„ç³»ç»Ÿç‰ˆæœ¬
3. **Team ç±»å‹ï¼š** ä¸ªäººå›¢é˜Ÿ or ç»„ç»‡å›¢é˜Ÿ
4. **é”™è¯¯ä¿¡æ¯ï¼š** Xcode æ§åˆ¶å°ä¸­çš„ä»»ä½•çº¢è‰²é”™è¯¯
5. **Capabilities æˆªå›¾ï¼š** Signing & Capabilities æ ‡ç­¾é¡µçš„æˆªå›¾

---

## âœ… æˆåŠŸæ ‡å¿—

å½“ä¸€åˆ‡é…ç½®æ­£ç¡®åï¼Œä½ åº”è¯¥çœ‹åˆ°ï¼š

1. **ç‚¹å‡» "Sign in with Apple" æŒ‰é’®**
2. **å±å¹•å¼¹å‡º Apple ç™»å½•ç•Œé¢**ï¼ˆè¿™æ˜¯ç³»ç»Ÿç•Œé¢ï¼Œä¸æ˜¯åº”ç”¨ç•Œé¢ï¼‰
3. **æ˜¾ç¤º "ä½¿ç”¨ Apple ç™»å½•" æ ‡é¢˜**
4. **æ˜¾ç¤ºä½ çš„ Apple ID**
5. **è¦æ±‚ Face ID éªŒè¯**
6. **éªŒè¯æˆåŠŸåè¿”å›åº”ç”¨**
7. **åº”ç”¨æ˜¾ç¤ºä½ çš„ç”¨æˆ·åå’Œ "iCloud å·²åŒæ­¥" çŠ¶æ€**

---

**ç¥ä½ é…ç½®æˆåŠŸï¼** ğŸ‰

å¦‚æœæˆåŠŸç™»å½•ï¼Œä½ çš„æ•°æ®å°±ä¼šè‡ªåŠ¨åŒæ­¥åˆ° iCloudï¼Œå¯ä»¥åœ¨æ‰€æœ‰è®¾å¤‡ä¸Šè®¿é—®äº†ï¼


