# 路线颜色区分功能说明

## 功能概述

根据路线的交通方式（徒步、机动车、公共交通等）使用不同的颜色显示，让用户能够直观地区分不同路段的交通方式。

## 颜色方案

### 徒步路线（绿色）
- **颜色**：`.green`
- **使用场景**：距离 ≤ 5公里的路段，自动使用徒步模式
- **视觉意义**：绿色代表自然、步行、环保，符合徒步场景

### 机动车路线（蓝色）
- **颜色**：`.blue`
- **使用场景**：距离 5-1000公里的路段，使用机动车模式
- **视觉意义**：蓝色是原有的路线颜色，保持一致性

### 公共交通路线（紫色）
- **颜色**：`.purple`
- **使用场景**：使用公共交通模式的路段
- **视觉意义**：紫色区分于其他交通方式

### 其他/混合路线（灰色）
- **颜色**：`.gray`
- **使用场景**：任意模式或其他混合交通方式
- **视觉意义**：灰色表示不确定或混合模式

## 技术实现

### 修改的文件
- `Footprint/Views/MapView.swift`：旅程tab的地图视图
- `Footprint/Views/TripRouteMapView.swift`：旅程详情页的地图视图

### 关键代码

```swift
/// 根据交通方式返回路线颜色
private func routeColor(for transportType: MKDirectionsTransportType) -> Color {
    if transportType.contains(.walking) && transportType == .walking {
        // 徒步模式：使用绿色
        return .green
    } else if transportType.contains(.automobile) && transportType == .automobile {
        // 机动车模式：使用蓝色
        return .blue
    } else if transportType.contains(.transit) && transportType == .transit {
        // 公共交通：使用紫色
        return .purple
    } else {
        // 其他或混合模式：使用灰色
        return .gray
    }
}
```

### 应用方式

在绘制路线时，根据路线的 `footprintTransportType` 属性选择颜色：

```swift
let routeColor = routeColor(for: route.footprintTransportType)

MapPolyline(route.polyline)
    .stroke(routeColor, style: StrokeStyle(...))
```

## 使用效果

### 之前
- 所有路线都使用蓝色
- 无法区分徒步和机动车路线
- 混合交通方式的旅程看起来都一样

### 现在
- **徒步路线**：绿色，清晰标识步行路段
- **机动车路线**：蓝色，保持原有视觉
- **公共交通路线**：紫色，区分其他方式
- **混合旅程**：不同路段使用不同颜色，一目了然

## 视觉示例

假设一个旅程包含：
1. 地点A → 地点B（3公里，山上徒步）→ **绿色路线**
2. 地点B → 地点C（2公里，山上徒步）→ **绿色路线**
3. 地点C → 地点D（50公里，坐车）→ **蓝色路线**

在地图上，用户可以清楚地看到：
- 前两段是绿色的徒步路线（山上路段）
- 最后一段是蓝色的机动车路线（坐车路段）

## 设计考虑

1. **颜色对比度**：所有颜色都使用白色描边，确保在任何背景下都清晰可见
2. **语义化**：颜色选择符合直觉（绿色=自然/步行，蓝色=道路/车辆）
3. **一致性**：两个视图（旅程tab和详情页）使用相同的颜色方案
4. **可访问性**：颜色不是唯一的信息传达方式，路线本身也包含距离标注

## 注意事项

1. **深色模式支持**：系统颜色（`.green`、`.blue`等）会自动适配深色模式
2. **颜色识别**：对于色盲用户，路线仍然可以通过距离标注和路线形状区分
3. **性能影响**：颜色选择是轻量级操作，不会影响性能

## 未来优化方向

1. **用户自定义**：允许用户在设置中选择喜欢的颜色方案
2. **更多交通方式**：支持自行车、飞机等更多交通方式的颜色区分
3. **颜色渐变**：对于长距离路线，可以使用渐变效果
4. **图例说明**：在地图上添加颜色图例，帮助用户理解

---

**更新日期**：2025-01-XX
**版本**：v1.0

