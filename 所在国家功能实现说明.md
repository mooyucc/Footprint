# 所在国家功能实现说明

## 功能概述
在设置页面添加了"所在国家"下拉菜单，默认设置为"中国"，用于区分国内和国外旅行。

## 实现的功能

### 1. 创建了CountryManager
- 位置：`Footprint/Helpers/CountryManager.swift`
- 功能：管理用户所在国家的设置
- 支持100+个国家的选择
- 包含中文名称、英文名称、国旗emoji
- 自动保存用户选择到UserDefaults
- 提供判断是否为国内旅行的功能

### 2. 创建了CountrySelectionView
- 位置：`Footprint/Views/CountrySelectionView.swift`
- 功能：国家选择界面
- 支持搜索功能（中文和英文）
- 显示国旗、中文名、英文名
- 当前选择的国家会显示勾选标记

### 3. 更新了SettingsView
- 在设置页面添加了"所在国家"选项
- 位置在语言设置之后，关于应用之前
- 显示当前选择的国家（国旗+中文名）
- 点击可打开国家选择界面
- 添加了功能说明文字

### 4. 添加了本地化支持
- 中文：`Footprint/Resources/zh-Hans.lproj/Localizable.strings`
- 英文：`Footprint/Resources/en.lproj/Localizable.strings`
- 新增的本地化键：
  - `country` = "所在国家" / "Country"
  - `country_selection` = "国家选择" / "Country Selection"
  - `country_description` = "设置你所在的国家，用于区分国内和国外旅行" / "Set your country to distinguish between domestic and international travel"
  - `search_countries` = "搜索国家..." / "Search countries..."

### 5. 更新了主应用
- 在`FootprintApp.swift`中添加了CountryManager的环境对象
- 确保所有视图都能访问CountryManager

## 技术特点

### 1. 国家数据
- 支持100+个国家/地区
- 每个国家包含：ISO代码、中文名、英文名、国旗emoji
- 按地区分类，便于查找

### 2. 用户体验
- 默认选择中国
- 支持搜索功能（中英文）
- 直观的国旗+名称显示
- 当前选择有明确标识

### 3. 数据持久化
- 使用UserDefaults保存用户选择
- 应用重启后保持设置
- 支持系统区域自动检测

### 4. 国际化支持
- 完整的中英文界面
- 本地化字符串支持
- 符合iOS设计规范

## 使用方法

1. 打开应用，进入"我的"页面
2. 点击右上角设置按钮
3. 在设置页面找到"所在国家"选项
4. 点击进入国家选择界面
5. 可以搜索或浏览选择国家
6. 选择后自动保存并返回设置页面

## 后续扩展

CountryManager提供了`isDomestic(country: String)`方法，可以用于：
- 判断目的地是否为国内旅行
- 在统计中区分国内/国外旅行
- 在地图视图中使用不同的搜索策略
- 在分享功能中显示不同的标签

## 编译状态
✅ 所有代码编译通过
✅ 无语法错误
✅ 本地化文件完整
✅ 用户体验完整

功能已完全实现并可以正常使用。
